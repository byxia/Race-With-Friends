<!DOCTYPE html> 
<html> 
<head> 
	<title>Race With Friends</title> 
	
	<meta name="viewport" content="width=device-width, initial-scale=1"> 

	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
	<link rel="stylesheet" href="css/themes/race.css" />
	<link rel="stylesheet" href="style.css" />

	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
	<script type="text/javascript" src="../clientAjax.js"></script>
</head> 
<body> 

<div data-role="page" id="new-race">
	<div data-role="header">
		<a href="active.html" data-transition="slide" data-direction="reverse" data-role="button" data-icon="arrow-l">
			back
		</a>
		<h1>Race With Friends</h1>
	</div>

	<div class="bar dark new-instruction">
		<p>Choose a friend to challenge!</p>
	</div>

	<div data-role="content" id="friend-list">
		<ul data-role="listview">
<!-- 				<li>
					<img class="avatar">
					<a href="profile.html">Adam Kinkaid</a>
				</li>
				<li>
					<img class="avatar">
					<a href="profile.html">Alex Wickerham</a>
				</li> -->
			</ul>
	</div>

	<div data-role="footer" data-position="fixed" class="footer"  data-tap-toggle="false">		
		<div data-role="navbar">
			<ul>
				<li>
					<a href="active.html" data-transition="slide"  class="ui-btn-active ui-state-persist" data-icon="active-races">
						Active Races
					</a>
				</li>
				<li><a href="finished.html" data-transition="slide" class="verify-link" data-icon="finished-races">Past Races</a></li>
				<li><a href="profile.html" data-transition="slide" class="info-link" data-icon="profile">Profile</a></li>
			</ul>
		</div><!-- /navbar -->
	</div><!-- /footer --><!-- /footer -->


	<script type="text/javascript">

		$('#new-race').bind('pageshow', function(){
			// alert("hello");

			getAllFriends(function  (list) {
				//check for error
				if (isNull(list)){
					console.log("error - null");
					return;
				}
				else if (list.status === 0){
					console.log("error");
					console.log(list.status);
					return;
				}

				// alert("world");
				list.sort(function(a,b) {
					return compare(a, b, "name"); 
				});

				for (var i=0; i<list.length; i++){
					$("<li><img class='avatar'><a href='profile.html?id="+list[i].id+"'><p>"+list[i].name+"</p></a></li>").appendTo('#friend-list ul').trigger("create");
				}

				$("#friend-list ul").listview("refresh");
			}, log);
		});

		function compare(el1, el2, index) {
		  return el1[index] == el2[index] ? 0 : (el1[index] < el2[index] ? -1 : 1);
		}

	</script>
</div>


</body>
</html>